{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ church.name }} - Home</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'serif': ['Georgia', 'serif'],
                    },
                    colors: {
                        'deep-blue': '#1e3a8a',
                        'white': '#ffffff',
                    }
                }
            }
        }
    </script>
<style>
/* Mobile-first responsive design */
@media (max-width: 640px) {
  /* Hero section fixes */
  section.relative.w-full.h-screen.overflow-hidden {
    height: 100vh !important;
    min-height: 100vh !important;
    max-height: none !important;
  }
  #hero-media-container,
  .hero-swiper,
  .hero-swiper .swiper-wrapper,
  .hero-swiper .swiper-slide,
  .hero-swiper img,
  .hero-swiper video {
    height: 100% !important;
    min-height: 100vh !important;
    max-height: none !important;
  }
  .max-w-5xl.mx-auto.px-6.py-32.flex.flex-col.items-center.text-center {
    padding-top: 2rem !important;
    padding-bottom: 2rem !important;
  }
  .text-5xl.md\:text-7xl.font-bold.mb-6.text-white.drop-shadow-lg {
    font-size: 2rem !important;
    margin-bottom: 1rem !important;
  }
  .text-xl.md\:text-2xl.mb-8.text-white.drop-shadow-lg.max-w-3xl {
    font-size: 1rem !important;
    margin-bottom: 1.5rem !important;
  }
  .flex.flex-col.sm\:flex-row.gap-4 {
    flex-direction: column !important;
    gap: 0.75rem !important;
  }
  .flex.flex-col.sm\:flex-row.gap-4 a {
    width: 100% !important;
    font-size: 1rem !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
  
  /* Section titles and content */
  .church-section-title {
    font-size: 1.25rem !important;
    margin-bottom: 0.75rem !important;
  }
  .church-section-subtitle {
    font-size: 0.875rem !important;
    margin-bottom: 0.75rem !important;
  }
  
  /* Card improvements for mobile */
  .church-card, .church-info-card {
    padding: 0.5rem !important;
    font-size: 0.9rem !important;
    border-radius: 0.75rem !important;
  }
  .church-card h3, .church-info-card h3 {
    font-size: 1rem !important;
    margin-bottom: 0.5rem !important;
  }
  .church-card p, .church-info-card p {
    font-size: 0.8rem !important;
    margin-bottom: 0.5rem !important;
  }
  
  /* Reduce card heights on mobile */
  .church-card .h-48, .church-card .h-40, .church-card .h-32 {
    height: 6rem !important;
    min-height: 0 !important;
    max-height: 7rem !important;
  }
  
  /* Sermon and News card specific fixes */
  .auto-scroll-sermons > div,
  .auto-scroll-news > div {
    min-width: 260px !important;
    max-width: 280px !important;
  }
  
  /* Reduce card height on mobile */
  .auto-scroll-sermons a,
  .auto-scroll-news a {
    min-height: 280px !important;
    max-height: 320px !important;
  }
  
  /* Text truncation for mobile */
  .auto-scroll-sermons .text-xl,
  .auto-scroll-news .text-xl {
    font-size: 1rem !important;
    line-height: 1.2 !important;
    margin-bottom: 0.5rem !important;
  }
  
  .auto-scroll-sermons .text-sm,
  .auto-scroll-news .text-sm {
    font-size: 0.75rem !important;
    line-height: 1.3 !important;
    margin-bottom: 0.5rem !important;
  }
  
  /* Limit text content on mobile */
  .auto-scroll-sermons p,
  .auto-scroll-news p {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 0.5rem !important;
  }
  
  /* Reduce padding on mobile */
  .auto-scroll-sermons .p-6,
  .auto-scroll-news .p-6 {
    padding: 0.75rem !important;
  }
  
  /* Grid improvements */
  .church-grid, .church-info-grid {
    grid-template-columns: 1fr 1fr !important;
    gap: 0.75rem !important;
  }
  .church-btn, .church-card a, .church-info-card a {
    font-size: 0.95rem !important;
    padding: 0.5rem 0.75rem !important;
  }
  .church-section {
    padding-top: 1.2rem !important;
    padding-bottom: 1.2rem !important;
  }
  .church-grid-container {
    max-width: 100% !important;
    width: 100% !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
  
  /* Global banner fixes */
  .church-global-banner {
    padding: 0 !important;
    background-color: #e0e7ff !important;
    min-height: 0 !important;
    height: auto !important;
  }
  .church-global-banner > .max-w-7xl,
  .church-global-banner .flex {
    min-height: 0 !important;
    height: auto !important;
    margin-bottom: 0 !important;
    padding: 0 !important;
  }
  .church-global-banner .mb-2,
  .church-global-banner .mb-2.sm\:mb-0 {
    margin-bottom: 0 !important;
  }
  .church-global-banner span, .church-global-banner .text-sm, .church-global-banner .font-medium {
    font-size: 10px !important;
    font-weight: 400 !important;
    line-height: 1.1 !important;
  }
  .church-global-banner a {
    font-size: 10px !important;
    padding: 0.05rem 0.3rem !important;
    border-radius: 0.15rem !important;
    height: 1.1rem !important;
    min-height: 0 !important;
    line-height: 1 !important;
  }
  .church-global-banner .flex {
    gap: 0.05rem !important;
    align-items: center !important;
  }
}

/* Tablet improvements */
@media (min-width: 641px) and (max-width: 768px) {
  .auto-scroll-sermons > div,
  .auto-scroll-news > div {
    min-width: 300px !important;
  }
  
  .auto-scroll-sermons a,
  .auto-scroll-news a {
    min-height: 300px !important;
  }
}

/* Force mobile layout for sermon cards */
@media (max-width: 767px) {
  .auto-scroll-sermons {
    display: flex !important;
    flex-direction: row !important;
    overflow-x: auto !important;
    gap: 1rem !important;
    padding-bottom: 1rem !important;
  }
  .auto-scroll-sermons > div {
    min-width: 260px !important;
    flex-shrink: 0 !important;
  }
}

/* Force mobile layout for news cards */
@media (max-width: 767px) {
  .auto-scroll-news {
    display: flex !important;
    flex-direction: row !important;
    overflow-x: auto !important;
    gap: 1rem !important;
    padding-bottom: 1rem !important;
  }
  .auto-scroll-news > div {
    min-width: 260px !important;
    flex-shrink: 0 !important;
  }
}

/* Ensure content doesn't interfere with swipe navigation */
.relative.z-10 {
  z-index: 10 !important; /* Lower than swipe area */
}

/* Ensure hero images are visible */
.hero-swiper img,
.hero-swiper video {
    display: block !important;
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
}

.swiper-slide {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

/* Ensure hero images are properly displayed */
.hero-swiper {
    width: 100% !important;
    height: 100% !important;
}

.swiper-slide {
    width: 100% !important;
    height: 100% !important;
}
</style>
</head>
<body class="bg-gray-50 text-[#1e3a8a] font-sans">
    <!-- Local Church Redirect Notification -->
    {% if request.session.local_church_redirect %}
    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
        <div class="flex">
            <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
            </div>
            <div class="ml-3">
                <p class="text-sm text-blue-700">
                    <strong>Welcome!</strong> We've automatically redirected you to <strong>{{ request.session.redirected_church }}</strong>, your nearest Bethel church.
                    <a href="{% url 'church_list' %}" class="font-medium underline hover:text-blue-600">View all churches</a> or 
                    <a href="{% url 'home' %}" class="font-medium underline hover:text-blue-600">visit the global site</a>.
                </p>
            </div>
            <div class="ml-auto pl-3">
                <div class="-mx-1.5 -my-1.5">
                    <button onclick="this.parentElement.parentElement.parentElement.parentElement.remove()" class="inline-flex bg-blue-50 rounded-md p-1.5 text-blue-500 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-blue-50 focus:ring-blue-600">
                        <span class="sr-only">Dismiss</span>
                        <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Clear redirect notification after display -->
    {% if request.session.clear_redirect_notification %}
    <script>
        // Clear the session variables after the page loads
        fetch('/clear-redirect-notification/', {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
                'Content-Type': 'application/json',
            },
        });
    </script>
    {% endif %}
    
    <!-- NAVBAR -->
    <header class="bg-[#1e3a8a] text-white py-4 px-4 flex items-center justify-between relative z-50">
        <div class="flex items-center space-x-4">
            {% if global_settings.global_nav_logo %}
                <img src="{{ global_settings.get_global_nav_logo_url }}" alt="Bethel Logo" class="w-8 h-8 rounded-full object-cover">
            {% elif church.nav_logo %}
                <img src="{{ church.get_nav_logo_url }}" alt="{{ church.name }} Logo" class="w-8 h-8 rounded-full object-cover">
            {% elif church.logo %}
                <img src="{{ church.get_logo_url }}" alt="{{ church.name }} Logo" class="w-8 h-8 rounded-full object-cover">
            {% else %}
                <img src="{% static 'img/bethel_logo.png' %}" alt="Bethel Logo" class="w-8 h-8 rounded-full">
            {% endif %}
            <span class="text-xs md:text-lg font-semibold font-serif leading-tight">{{ church.name }}</span>
        </div>
        <!-- Desktop Nav (hidden on mobile) -->
        <nav class="hidden md:flex space-x-6 text-sm">
            <a href="{% url 'church_home' church.id %}?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-white">Home</a>
            <a href="{% url 'church_about' church.id %}?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">About</a>
            <a href="{% url 'church_events' church.id %}?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Events</a>
            <a href="{% url 'church_ministries' church.id %}?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Ministries</a>
            <a href="{% url 'church_sermons' church.id %}?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Sermons</a>
            <a href="{% url 'church_news' church.id %}?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">News</a>
            {% if church.shop_url %}
                <a href="{{ church.shop_url }}" target="_blank" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Shop</a>
            {% else %}
                <a href="/shop" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Shop</a>
            {% endif %}
            <a href="{% url 'church_donation' church.id %}?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Give</a>
            <a href="/churches/" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Find Other Churches</a>
            <a href="/?global=true" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Global Site</a>
            <a href="/local-admin/" class="text-white hover:text-gray-200 transition-colors border-b-2 border-transparent hover:border-white">Admin</a>
        </nav>
        <!-- Mobile Hamburger Button -->
        <button id="mobile-menu-button" class="md:hidden text-white hover:text-gray-200 focus:outline-none" aria-label="Open menu">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>
    </header>
    
    <!-- Mobile Menu (separate from header) -->
    <div id="mobile-menu" class="fixed inset-0 z-50 bg-[#1e3a8a] bg-opacity-95 flex flex-col text-lg font-semibold text-white hidden">
        <!-- Close button at the top (fixed) -->
        <button id="mobile-menu-close" class="absolute top-4 right-4 text-3xl text-white hover:text-gray-300 p-2 z-10" aria-label="Close menu">&times;</button>
        
        <!-- Scrollable navigation links container -->
        <div class="flex-1 overflow-y-auto pt-16 pb-8">
            <div class="w-full max-w-sm mx-auto px-4">
                <a href="{% url 'church_home' church.id %}?global=true" class="block w-full text-center py-3 bg-white bg-opacity-20 rounded-lg mb-2">Home</a>
                <a href="{% url 'church_about' church.id %}?global=true" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">About</a>
                <a href="{% url 'church_events' church.id %}?global=true" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Events</a>
                <a href="{% url 'church_ministries' church.id %}?global=true" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Ministries</a>
                <a href="{% url 'church_sermons' church.id %}?global=true" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Sermons</a>
                <a href="{% url 'church_news' church.id %}?global=true" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">News</a>
                {% if church.shop_url %}
                    <a href="{{ church.shop_url }}" target="_blank" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Shop</a>
                {% else %}
                    <a href="/shop" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Shop</a>
                {% endif %}
                <a href="{% url 'church_donation' church.id %}?global=true" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Give</a>
                <a href="/churches/" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Find Other Churches</a>
                <a href="{% url 'home' %}?global=1" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Global Site</a>
                <a href="/local-admin/" class="block w-full text-center py-3 hover:bg-white hover:bg-opacity-20 rounded-lg mb-2">Admin</a>
            </div>
        </div>
    </div>

<!-- Global Site Navigation Banner -->
<div class="bg-[#e0e7ff] text-[#1e3a8a] py-3 px-6 church-global-banner">
    <div class="max-w-7xl mx-auto flex flex-col sm:flex-row items-center justify-between">
        <div class="flex items-center space-x-3 mb-2 sm:mb-0">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
            </svg>
            <span class="text-sm font-medium">You're viewing {{ church.name }}</span>
        </div>
        <div class="flex space-x-3">
            <a href="/churches/" class="bg-white text-[#1e3a8a] hover:bg-gray-100 px-4 py-1 rounded text-sm font-medium transition duration-200">
                Find Other Churches
            </a>
            <a href="{% url 'home' %}?global=1" class="bg-transparent border border-[#1e3a8a] text-[#1e3a8a] hover:bg-[#1e3a8a] hover:text-white px-4 py-1 rounded text-sm font-medium transition duration-200">
                Go to Global Site
            </a>
        </div>
    </div>
</div>

<!-- Location Detection Banner - Only show on local church sites -->


<!-- Hero Section -->
<section class="relative w-full h-screen overflow-hidden hero-section-outer">
    {% if hero %}
        
        <div id="hero-media-container" class="absolute inset-0 w-full h-full">
            {% if hero.hero_media.all %}
            <!-- Swiper Carousel -->
            <div class="swiper hero-swiper h-full">
                <div class="swiper-wrapper h-full">
                    {% for media in hero.hero_media.all|dictsort:'order' %}
                        {% if media.image %}
                        <div class="swiper-slide h-full">
                            <img src="{{ media.get_image_url }}" alt="Hero Media" class="w-full h-full object-cover" />
                        </div>
                        {% endif %}
                        {% if media.video %}
                        <div class="swiper-slide h-full">
                            <video autoplay muted loop playsinline class="w-full h-full object-cover">
                                <source src="{{ media.get_video_url }}" type="video/mp4" />
                            </video>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <!-- Add Pagination -->
                <div class="swiper-pagination"></div>
            </div>
            {% elif hero.background_type == 'video' and hero.background_video %}
                <video autoPlay muted loop playsInline class="absolute inset-0 w-full h-full object-cover">
                    <source src="{{ hero.background_video }}" type="video/mp4" />
                </video>
            {% elif hero.background_type == 'image' and hero.background_image %}
                <img src="{{ hero.get_background_image_url }}" alt="{{ hero.title }}" class="absolute inset-0 w-full h-full object-cover" />
            {% endif %}
        </div>
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="absolute inset-0 flex flex-col justify-center items-center z-10 px-6 text-center max-w-5xl mx-auto">
            <h1 class="text-5xl md:text-7xl font-bold mb-6 text-white drop-shadow-lg church-hero-title">{{ hero.title }}</h1>
            <p class="text-xl md:text-2xl mb-8 text-white drop-shadow-lg max-w-3xl church-hero-subtitle">{{ hero.subtitle }}</p>
            <div class="flex flex-col sm:flex-row gap-4">
                <a href="{{ hero.primary_button_link }}" class="bg-[#1e3a8a] hover:bg-white text-white px-8 py-3 rounded-lg font-semibold transition duration-300">
                    {{ hero.primary_button_text }}
                </a>
                <a href="{{ hero.secondary_button_link }}" class="bg-transparent border-2 border-white text-white hover:bg-white hover:text-[#1e3a8a] px-8 py-3 rounded-lg font-semibold transition duration-300">
                    {{ hero.secondary_button_text }}
                </a>
            </div>
        </div>
    {% else %}
        <!-- Fallback hero -->
        <div class="absolute inset-0 bg-deep-blue"></div>
        <div class="relative z-10 max-w-5xl mx-auto px-6 py-32 flex flex-col items-center text-center church-hero-section">
            <h1 class="text-5xl md:text-7xl font-bold mb-6 text-white church-hero-title">Welcome to {{ church.name }}</h1>
            <p class="text-xl md:text-2xl mb-8 text-white max-w-3xl church-hero-subtitle">Join us in worship and community as we grow together in faith.</p>
            <div class="flex flex-col sm:flex-row gap-4">
                <a href="{% url 'church_about' church.id %}" class="bg-[#1e3a8a] hover:bg-white text-white px-8 py-3 rounded-lg font-semibold transition duration-300">Plan Your Visit</a>
                <a href="{% url 'church_sermons' church.id %}" class="bg-transparent border-2 border-white text-white hover:bg-white hover:text-deep-blue px-8 py-3 rounded-lg font-semibold transition duration-300">Watch Online</a>
            </div>
            <div class="mt-6">
                <a href="{% url 'home' %}?global=1" class="bg-white text-[#1e3a8a] hover:bg-gray-100 px-6 py-2 rounded-lg font-semibold transition duration-300 text-sm">
                    Go to Global Site
                </a>
            </div>
        </div>
    {% endif %}
</section>



<!-- Church Info -->
<div class="container mx-auto px-4 py-12 church-section">
    <div class="max-w-4xl mx-auto text-center church-info-card">
        <h2 class="text-3xl font-bold text-gray-900 mb-6 church-section-title">Welcome to {{ church.name }}</h2>
        <p class="text-lg text-gray-700 leading-relaxed church-section-subtitle">{{ church.description|default:"Join us for worship, fellowship, and spiritual growth." }}</p>
    </div>
</div>

<!-- Quick Info -->
<div class="container mx-auto px-4 pb-12 church-section">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-lg shadow-md p-6 text-center church-info-card">
            <div class="flex flex-col md:flex-row md:justify-around gap-6">
                <div>
                    <div class="text-[#1e3a8a] text-3xl mb-2">📍</div>
                    <h3 class="text-lg font-semibold mb-2">Location</h3>
                    <p class="text-gray-600">{{ church.address|default:"Contact us for directions" }}</p>
                </div>
                <div>
                    <div class="text-[#1e3a8a] text-3xl mb-2">⏰</div>
                    <h3 class="text-lg font-semibold mb-2">Service Times</h3>
                    <p class="text-gray-600">
                        {% if church.service_times %}
                            {{ church.service_times }}
                        {% elif church.sunday_service_1 or church.wednesday_service or church.friday_service %}
                            {% if church.sunday_service_1 %}Sunday {{ church.sunday_service_1|time:"g:i A" }}{% if church.sunday_service_2 %} & {{ church.sunday_service_2|time:"g:i A" }}{% endif %}{% endif %}
                            {% if church.wednesday_service %}{% if church.sunday_service_1 %}<br>{% endif %}Wednesday {{ church.wednesday_service|time:"g:i A" }}{% endif %}
                            {% if church.friday_service %}{% if church.sunday_service_1 or church.wednesday_service %}<br>{% endif %}Friday {{ church.friday_service|time:"g:i A" }}{% endif %}
                        {% else %}
                            Sunday 9:00 AM & 11:00 AM
                        {% endif %}
                    </p>
                </div>
                <div>
                    <div class="text-[#1e3a8a] text-3xl mb-2">📞</div>
                    <h3 class="text-lg font-semibold mb-2">Contact</h3>
                    <p class="text-gray-600">{{ church.phone|default:"Contact us for more information" }}</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Calendar Section -->
<section class="bg-white py-16 church-section">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12 bg-white rounded-t-xl p-8 church-info-card">
            <h2 class="text-3xl font-bold text-[#1e3a8a] mb-4 church-section-title">Event Calendar</h2>
            <p class="text-lg text-gray-700 church-section-subtitle">View all our events in a monthly calendar format</p>
        </div>
        <div class="bg-gradient-to-r from-[#1e3a8a] to-[#1e3a8a] rounded-b-xl p-8 text-center church-info-card">
            <div class="text-[#1e3a8a] text-6xl mb-4">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <h3 class="text-2xl font-bold text-white mb-4 church-section-title">Stay Connected</h3>
            <p class="text-white mb-6 church-section-subtitle">Never miss an event! View our complete calendar with all upcoming activities, services, and special events.</p>
            <div class="space-x-4">
                <a href="{% url 'church_calendar' church.id %}" class="bg-white text-[#1e3a8a] px-8 py-3 rounded-lg font-semibold transition duration-300 hover:bg-gray-100 church-btn">
                    <i class="fas fa-calendar-alt"></i> View Calendar
                </a>
                <a href="{% url 'church_events' church.id %}" class="bg-white text-[#1e3a8a] px-8 py-3 rounded-lg font-semibold transition duration-300 hover:bg-gray-100 church-btn">
                    All Events
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Featured Events Section -->
{% if events %}
<section class="bg-gray-50 py-16 church-section">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 church-grid-container">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-deep-blue mb-4 church-section-title">Upcoming Events at {{ church.name }}</h2>
            <p class="text-lg text-gray-600 church-section-subtitle">Join us for these special gatherings and celebrations</p>
        </div>
        <div class="auto-scroll-events flex space-x-4 overflow-x-auto md:grid md:grid-cols-2 lg:grid-cols-3 md:space-x-0 md:gap-8">
            {% for event in events %}
                <div class="min-w-[280px] md:min-w-0">{% include 'core/_event_card.html' with event=event church=church %}</div>
            {% endfor %}
        </div>
        <div class="text-center mt-8">
            <a href="{% url 'church_events' church.id %}" class="bg-[#1e3a8a] hover:bg-white text-white px-8 py-3 rounded-lg font-semibold transition duration-300 church-btn">View All Events</a>
        </div>
    </div>
</section>
{% else %}
<section class="bg-white py-16 church-section">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 church-grid-container">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-[#1e3a8a] mb-4 church-section-title">Upcoming Events at {{ church.name }}</h2>
            <p class="text-lg text-gray-600 church-section-subtitle">Join us for these special gatherings and celebrations</p>
        </div>
        <div class="flex justify-center">
            <div class="bg-white border border-[#1e3a8a] rounded-xl shadow-md p-10 text-center church-info-card">
                <p class="text-[#1e3a8a] text-xl font-semibold">No upcoming events at the moment. Check back soon!</p>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Ministries Section -->
{% if ministries %}
<section class="bg-white py-16 church-section">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 church-grid-container">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-deep-blue mb-4 church-section-title">Our Ministries</h2>
            <p class="text-lg text-gray-600 church-section-subtitle">Discover ways to get involved and grow in your faith</p>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-2 md:gap-4 lg:gap-6">
            {% for ministry in ministries %}
            <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition flex flex-col min-h-[280px] md:min-h-[340px] h-full">
                {% if ministry.image %}
                <img src="{{ ministry.get_image_url }}" alt="{{ ministry.name }}" class="w-full h-32 object-cover">
                {% else %}
                <div class="h-32 bg-gradient-to-br from-[#6366f1] to-[#1e3a8a] flex items-center justify-center">
                    <i class="fas fa-hands-helping text-white text-6xl"></i>
                </div>
                {% endif %}
                <div class="p-4 md:p-6 flex flex-col flex-1">
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-2">{{ ministry.name }}</h3>
                    <p class="text-gray-700 text-sm mb-3 md:mb-4 line-clamp-2">{{ ministry.description }}</p>
                    <a href="{% url 'church_ministry_detail' church.id ministry.id %}" class="text-[#1e3a8a] hover:text-[#1e3a8a] font-semibold mt-auto">Learn More →</a>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-8">
            <a href="{% url 'church_ministries' church.id %}" class="bg-[#1e3a8a] hover:bg-white text-white px-8 py-3 rounded-lg font-semibold transition duration-300 church-btn">View All Ministries</a>
        </div>
    </div>
</section>
{% endif %}

<!-- Latest Sermons Section -->
{% if sermons %}
<section class="py-16 bg-very-white church-section">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 church-grid-container">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-deep-blue mb-4 church-section-title">Latest Sermons</h2>
            <p class="text-lg text-gray-600 church-section-subtitle">Listen to inspiring messages from our pastors</p>
        </div>
        <div class="auto-scroll-sermons flex space-x-4 overflow-x-auto md:grid md:grid-cols-2 lg:grid-cols-3 md:space-x-0 md:gap-8">
            {% for sermon in sermons|slice:':3' %}
                <div class="min-w-[280px] md:min-w-0">{% include 'core/_sermon_card.html' with sermon=sermon church=church %}</div>
            {% endfor %}
        </div>
        <div class="text-center mt-8">
            <a href="{% url 'church_sermons' church.id %}" class="bg-[#1e3a8a] hover:bg-white text-white px-8 py-3 rounded-lg font-semibold transition duration-300 church-btn">View All Sermons</a>
        </div>
    </div>
</section>
{% endif %}

<!-- Latest News Section -->
{% if news %}
<section class="bg-gray-50 py-16 church-section">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 church-grid-container">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-deep-blue mb-4 church-section-title">Latest News from {{ church.name }}</h2>
            <p class="text-lg text-gray-600 church-section-subtitle">Stay updated with the latest happenings in our church community</p>
        </div>
        <div class="auto-scroll-news flex space-x-4 overflow-x-auto md:grid md:grid-cols-2 lg:grid-cols-3 md:space-x-0 md:gap-8">
            {% for article in news %}
                <a href="{% url 'news_detail' article.id %}" class="min-w-[280px] md:min-w-0 bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-lg transition flex flex-col h-full focus:outline-none focus:ring-2 focus:ring-[#1e3a8a]">
                    {% if article.image %}
                    <img src="{{ article.get_image_url }}" alt="{{ article.title }}" class="w-full h-32 object-cover">
                    {% else %}
                    <div class="h-32 bg-gradient-to-r from-orange-500 to-red-500 flex items-center justify-center">
                        <i class="fas fa-newspaper text-white text-6xl"></i>
                    </div>
                    {% endif %}
                    <div class="p-6 flex flex-col flex-1">
                        <h3 class="text-xl font-semibold mb-2 text-deep-blue line-clamp-2">{{ article.title }}</h3>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2 flex-1">{{ article.content|striptags|truncatewords:15 }}</p>
                        <span class="text-[#1e3a8a] font-semibold text-sm">{{ article.date|date:"M d, Y" }}</span>
                    </div>
                </a>
            {% endfor %}
        </div>
        <div class="text-center mt-8">
            <a href="{% url 'church_news' church.id %}" class="bg-[#1e3a8a] hover:bg-white text-white px-8 py-3 rounded-lg font-semibold transition duration-300 church-btn">View All News</a>
        </div>
    </div>
</section>
{% endif %}

<!-- Call to Action -->
<div class="container mx-auto px-4 py-12 church-section">
    <div class="bg-gradient-to-r from-[#1e3a8a] to-[#1e3a8a] rounded-lg p-8 text-center text-white church-info-card">
        <h3 class="text-2xl font-bold mb-4 church-section-title">Join Us This Sunday</h3>
        <p class="text-lg mb-6 church-section-subtitle">Experience the love of Christ in our community. Everyone is welcome!</p>
        <div class="flex flex-col sm:flex-row gap-3 justify-center items-center mt-4">
    <a href="{% url 'church_about' church.id %}" class="bg-white text-[#1e3a8a] px-6 py-3 rounded-md font-semibold hover:bg-gray-100 transition duration-200 church-btn w-full sm:w-auto">Learn More About Us</a>
    <a href="{% url 'church_donation' church.id %}" class="bg-[#1e3a8a] text-white px-6 py-3 rounded-md font-semibold hover:bg-[#1e3a8a] transition duration-200 church-btn w-full sm:w-auto">Support Our Ministry</a>
</div>
    </div>
</div>

<!-- Swiper.js CDN -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<style>
/* Ensure hero section is touch-enabled */
.hero-section-outer {
    touch-action: pan-y pinch-zoom;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.hero-swiper {
    touch-action: pan-y pinch-zoom;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.swiper-slide {
    touch-action: pan-y pinch-zoom;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, initializing Swiper...');
    
    // Check if Swiper element exists
    const swiperElement = document.querySelector('.hero-swiper');
    if (swiperElement) {
        console.log('Swiper element found, initializing...');
        console.log('Swiper slides found:', swiperElement.querySelectorAll('.swiper-slide').length);
        
        // Initialize Swiper for hero carousel with swipe navigation
        const swiper = new Swiper('.hero-swiper', {
            loop: true,
            autoplay: { delay: 5000, disableOnInteraction: false },
            pagination: { el: '.swiper-pagination', clickable: true },
            effect: 'fade',
            fadeEffect: {
                crossFade: true
            },
            // Enhanced touch/swipe navigation
            allowTouchMove: true,
            grabCursor: true,
            touchRatio: 1,
            touchAngle: 45,
            touchMoveStopPropagation: false,
            touchStartPreventDefault: false,
            touchStartForcePreventDefault: false,
            touchMoveForcePreventDefault: false,
            // Enable swipe gestures
            shortSwipes: true,
            longSwipes: true,
            longSwipesRatio: 0.5,
            longSwipesMs: 300,
            followFinger: true,
            threshold: 5,
            // Prevent conflicts with page scrolling
            preventInteractionOnTransition: false,
        });
        
        console.log('Swiper initialized successfully:', swiper);
        
        // Test touch events
        swiper.on('touchStart', function() {
            console.log('Touch start detected');
        });
        
        swiper.on('touchMove', function() {
            console.log('Touch move detected');
        });
        
        swiper.on('slideChange', function() {
            console.log('Slide changed to:', swiper.activeIndex);
        });
        
        // Test if touch is enabled
        console.log('Touch enabled:', swiper.allowTouchMove);
        console.log('Touch ratio:', swiper.touchRatio);
        
    } else {
        console.log('Swiper element not found');
    }
    
    // Debug hero media container
    const heroContainer = document.getElementById('hero-media-container');
    if (heroContainer) {
        console.log('Hero media container found');
        const images = heroContainer.querySelectorAll('img');
        console.log('Images found in hero container:', images.length);
        images.forEach((img, index) => {
            console.log(`Image ${index}:`, img.src, img.complete ? 'loaded' : 'loading');
        });
    } else {
        console.log('Hero media container not found');
    }
});
</script>

    <script>
        // Auto-scroll script for carousels
        function autoScrollCarousel(selector, interval = 2000) {
            const container = document.querySelector(selector);
            if (!container) return;
            let scrollAmount = 0;
            let maxScroll = container.scrollWidth - container.clientWidth;
            let direction = 1;
            setInterval(() => {
                if (window.innerWidth >= 768) return; // Only auto-scroll on mobile
                if (container.scrollLeft >= maxScroll) {
                    direction = -1;
                } else if (container.scrollLeft <= 0) {
                    direction = 1;
                }
                scrollAmount = direction === 1 ? container.scrollLeft + 300 : container.scrollLeft - 300;
                container.scrollTo({ left: scrollAmount, behavior: 'smooth' });
            }, interval);
        }
        document.addEventListener('DOMContentLoaded', function() {
            autoScrollCarousel('.auto-scroll-events');
            autoScrollCarousel('.auto-scroll-sermons');
            autoScrollCarousel('.auto-scroll-news');
        });
    </script>
    <script>
        // Mobile menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            const menuBtn = document.getElementById('mobile-menu-button');
            const menu = document.getElementById('mobile-menu');
            const closeBtn = document.getElementById('mobile-menu-close');
            
            function openMobileMenu() {
                menu.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            }
            
            function closeMobileMenu() {
                menu.classList.add('hidden');
                document.body.style.overflow = ''; // Restore scrolling
            }
            
            // Open menu
            if (menuBtn) {
                menuBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    openMobileMenu();
                });
            }
            
            // Close menu
            if (closeBtn) {
                closeBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    closeMobileMenu();
                });
            }
            
            // Close menu when clicking a link
            if (menu) {
                menu.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', function() {
                        closeMobileMenu();
                    });
                });
            }
            
            // Close menu when clicking outside
            menu.addEventListener('click', function(e) {
                if (e.target === menu) {
                    closeMobileMenu();
                }
            });
            
            // Close menu on escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && !menu.classList.contains('hidden')) {
                    closeMobileMenu();
                }
            });
        });
    </script>
    
    <!-- Cookie Consent Popup -->
    {% include 'core/cookie_consent.html' %}
</body>
</html>
